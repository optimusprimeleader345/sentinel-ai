import express from 'express'
import {
  assessSingleVulnerability,
  assessBatchVulnerabilities,
  assessSystemVulnerabilities,
  getRiskPredictions,
  getPatchRecommendations,
  getComplianceImpact,
  getAIVulnerabilityInsights
} from '../controllers/aiVulnerabilityController.js'
import { optionalAuth } from '../middleware/authMiddleware.js'

const router = express.Router()

// Single vulnerability assessment
router.post('/assess', optionalAuth, assessSingleVulnerability)

// Batch vulnerability assessment
router.post('/assess/batch', optionalAuth, assessBatchVulnerabilities)

// System-specific vulnerability assessment
router.get('/system/:systemId/:scanType?', optionalAuth, assessSystemVulnerabilities)

// Risk predictions and forecasting
router.get('/predictions', optionalAuth, getRiskPredictions)

// Patch recommendations with AI prioritization
router.get('/patches', optionalAuth, getPatchRecommendations)

// Compliance impact assessment
router.get('/compliance/:framework', optionalAuth, getComplianceImpact)

// AI-generated vulnerability insights and analytics
router.get('/insights', optionalAuth, getAIVulnerabilityInsights)

export default router
